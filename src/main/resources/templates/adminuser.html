<!DOCTYPE html>
<html xmlns:th="http://tymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>ユーザー管理</title>
</head>
<body>
    <div th:insert="~{navbar}">  </div>
    <input id="csrf" type="hidden" th:name="${_csrf.headerName}" th:value="${_csrf.token}" />
    <br>
    <br>
    <br>
    <table id="users">
    </table>

    <script th:src="@{/js/refresh.js}"></script>
    <script>
        refreshUsers();

        //ユーザーの表示を更新する関数
        function refreshUsers() {
            getRequest("getusers", function(response){
                var js = JSON.parse(response);
                var dt = document.getElementById("users");
                dt.innerHTML = "";
                js.forEach(element => {
                    dt.innerHTML += 
                    '<tr>' + 
                    '<td name="id"> ' + element.id + '</td>' +
                    '<td name="userName">' + element.userName + ' </td>' +
                    '<td name="nickName">' + element.nickName + ' </td>' +
                    '<td><form action="/modifyuser">'+
                        '<input name="id" value=' + element.id + '>' +
                        '<button type="submit" >修正</button>' +
                    '</form></td>' + 
                    '<tr>';
                });
            })
        }

    </script>
</body>
</html>